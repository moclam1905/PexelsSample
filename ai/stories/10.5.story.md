
# Story 10.5: Enhance HomeScreen UI/UX (Placeholders, Shimmer, Spacing, Corners)

**Status:** Draft

## Goal & Context

**User Story:** As a user, I want the HomeScreen grid to look highly polished and modern, with smooth loading indicators and visually appealing item presentation.

**Context:** This story focuses on the UI polish aspects for the `HomeScreen`'s `LazyVerticalStaggeredGrid`, as detailed in PRD v1.2 [48], [57], [89], [193], [202], [234], [464], [473], [505] and the `research-homescreen-trending-photos.md` document. It includes implementing shimmer loading effects, item spacing, rounded corners, and proper content padding.

## Detailed Requirements

* Define `Arrangement.spacedBy(...)` for `LazyVerticalStaggeredGrid`'s `verticalItemSpacing` and `horizontalArrangement` to ensure consistent spacing between items (e.g., 8.dp).
* Apply `Modifier.clip(RoundedCornerShape(X.dp))` (e.g., 8.dp or 12.dp) to each `ImageItem` when displayed in the HomeScreen grid.
* `AsyncImage` within `ImageItem` should use a color placeholder (e.g., from `Photo.avgColor` if available and parsed quickly, or a default light grey color). This might already be part of `ImageItem` from Epic 3 but should be verified for HomeScreen context.
* Implement or integrate a shimmer effect:
    * If a library is chosen (e.g., `com.valentinilk.shimmer` Compose wrapper, or a Compose-native one like those explored in research), add the dependency.
    * The shimmer effect should be applied as a visual overlay or background to the placeholder areas of `ImageItem`s while their actual images are loading via Coil.
* Add `contentPadding` to the `LazyVerticalStaggeredGrid` itself (e.g., 8.dp or 12.dp) to ensure content isn't flush against screen edges.

## Acceptance Criteria (ACs)

* AC1: `LazyVerticalStaggeredGrid` items on `HomeScreen` have consistent vertical and horizontal spacing (e.g., 8.dp).
* AC2: `ImageItem`s displayed in the HomeScreen grid have rounded corners (e.g., 8.dp or 12.dp).
* AC3: A shimmer loading effect is displayed over `ImageItem` placeholders while their respective images are loading from Coil. The shimmer is smooth and visually appealing.
* AC4: `LazyVerticalStaggeredGrid` has appropriate `contentPadding` from the screen edges.
* AC5: The overall loading experience for images in the grid feels polished, modern, and reduces perceived wait time due to effective placeholders and shimmer.

## Technical Implementation Context

**Guidance:** Use the following details for implementation. Story 10.1 established the basic grid.

* **Relevant Files:**
    * Files to Modify:
        * `app/src/main/java/com/nguyenmoclam/pexelssample/ui/home/HomeScreen.kt` (for grid parameters like spacing, contentPadding).
        * `app/src/main/java/com/nguyenmoclam/pexelssample/ui/common/ImageItem.kt` (to integrate shimmer effect or ensure placeholder is shimmer-compatible, and apply rounded corners if not already conditional).
        * `libs.versions.toml` & `app/build.gradle.kts` (if a shimmer library is added).
    * Files to Create:
        * Potentially a `ShimmerBrush.kt` or reusable shimmer Composable if implementing manually or wrapping a library.
    * _(Hint: `research-homescreen-trending-photos.md` [Enhanced UI/UX section]. PRD [89], [202], [234], [473], [505]. `tech-stack.md` mentions TBD for shimmer library.)_

* **Key Technologies:**
    * Jetpack Compose: `LazyVerticalStaggeredGrid` parameters (`verticalItemSpacing`, `horizontalArrangement`, `contentPadding`), `Modifier.clip(RoundedCornerShape)`, `Modifier.background`.
    * Coil `AsyncImage` (for placeholder support).
    * Shimmer Effect: Either a library (e.g., `com.valentinilk:shimmer-compose` if a Compose version exists or a similar one) or a custom implementation using Compose graphics APIs (`Brush.linearGradient` animated).
    * _(Hint: `tech-stack.md`. `coding-standards.md` updated for shimmer.)_

* **API Interactions / SDK Usage:**
    * Not applicable.
    * _(Hint: See `docs/api-reference.md`)_

* **Data Structures:**
    * Not applicable.
    * _(Hint: See `data-models.md v1.1`.)_

* **Environment Variables:**
    * Not applicable.
    * _(Hint: See `environment-vars.md`)_

* **Coding Standards Notes:**
    * Shimmer effect should be subtle and performant.
    * Rounded corners and spacing should be consistent with Material Design principles.
    * Ensure shimmer correctly stops when image loads or errors out.
    * Adhere to `docs/coding-standards.md`.
    * _(Hint: See `docs/coding-standards.md`.)_

## Tasks / Subtasks

* [ ] **Implement Grid Spacing and Padding on `HomeScreen.kt`:**
    * [ ] Set `verticalItemSpacing = 8.dp` (or similar) on `LazyVerticalStaggeredGrid`.
    * [ ] Set `horizontalArrangement = Arrangement.spacedBy(8.dp)` (or similar) on `LazyVerticalStaggeredGrid`.
    * [ ] Set `contentPadding = PaddingValues(8.dp)` (or similar) on `LazyVerticalStaggeredGrid`.
* [ ] **Apply Rounded Corners in `ImageItem.kt`:**
    * [ ] Apply `modifier = Modifier.clip(RoundedCornerShape(12.dp))` to the root container of `ImageItem` (e.g., the `Card` or `Box` that holds the `AsyncImage`).
* [ ] **Research and Integrate Shimmer Effect (Primary Task):**
    * [ ] Evaluate Compose shimmer libraries (e.g., check for a Compose version of `com.valentinilk.shimmer` or alternatives like those on GitHub - `com.google.accompanist:accompanist-placeholder` used to have shimmer, check for M3 equivalents or if foundation provides tools). *If no simple, well-maintained library, a basic manual shimmer might be needed.*
    * [ ] Add chosen library dependency to Gradle files.
    * [ ] Modify `ImageItem.kt`:
        * The `placeholder` slot of `AsyncImage` should be designed to work with the shimmer. This might mean the placeholder itself is a simple colored `Box`.
        * Apply the shimmer effect modifier conditionally when `AsyncImagePainter.State` is `Loading` or `Empty`.
        ```kotlin
        // Example structure within ImageItem, assuming a shimmer modifier like Modifier.shimmerLoadingAnimation()
        // val painter = rememberAsyncImagePainter(model = photo.src.medium) // Or AsyncImage
        // Box(modifier = Modifier.clip(RoundedCornerShape(12.dp))) {
        //     if (painter.state is AsyncImagePainter.State.Loading || painter.state is AsyncImagePainter.State.Empty) {
        //         Box(modifier = Modifier.matchParentSize().background(parseColor(photo.avgColor)).shimmerLoadingAnimation())
        //     }
        //     Image( // Or AsyncImage
        //         painter = painter, 
        //         contentDescription = photo.alt, ...
        //     )
        // }
        // More idiomatic with AsyncImage's placeholder slot:
        // AsyncImage(
        //    model = ...,
        //    placeholder = { Box(modifier = Modifier.fillMaxSize().background(Color.LightGray).then(if (isLoading) Modifier.shimmer() else Modifier)) }
        //    // 'isLoading' here would be derived from AsyncImage's state if directly inspectable, or a shimmer applied to a static placeholder.
        // )
        ```
      A common pattern is to have the placeholder Composable take a boolean `isLoading` and apply shimmer if true. The `AsyncImage`'s `onState` callback can update this boolean.
* [ ] Test shimmer effect, spacing, and corners visually.

## Testing Requirements

**Guidance:** Verify implementation against the ACs using the following tests.

* **Unit Tests:**
    * Not primary for visual UI polish.
* **Integration Tests (UI Tests):**
    * (Challenging for shimmer) Can verify `contentPadding` and item modifiers (like clip) are applied using semantic queries if possible.
    * _(Refer to `testing-strategy.md`.)_
* **Manual/CLI Verification (Primary method):**
    * AC1: Visually inspect `HomeScreen` grid. Confirm consistent spacing between items both vertically and horizontally.
    * AC2: Confirm `ImageItem`s have rounded corners.
    * AC3: Observe `ImageItem`s as they load. Verify a shimmer effect plays over their placeholder area before the image appears. The shimmer should be smooth.
    * AC4: Confirm `LazyVerticalStaggeredGrid` has padding from screen edges.
    * AC5: Assess the overall visual appeal and perceived performance during loading. The shimmer should make loading feel less static.
* _(Hint: See `testing-strategy.md` and `research-homescreen-trending-photos.md` [Enhanced UI/UX section].)_